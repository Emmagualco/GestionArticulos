{"ast":null,"code":"import React from\"react\";import ExcelJS from\"exceljs\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ImportExcel=_ref=>{let{onData}=_ref;const[feedback,setFeedback]=React.useState(\"\");const handleFileUpload=async e=>{try{const file=e.target.files[0];if(!file)return;const workbook=new ExcelJS.Workbook();const arrayBuffer=await file.arrayBuffer();await workbook.xlsx.load(arrayBuffer);const worksheet=workbook.worksheets[0];const data=[];const headers=worksheet.getRow(1).values.slice(1).map((h,i)=>h?h.toString():\"column\".concat(i+1));worksheet.eachRow((row,rowNumber)=>{if(rowNumber===1)return;const rowData=row.values.slice(1);const item={};headers.forEach((header,i)=>{item[header.toLowerCase()]=rowData[i];});data.push(item);});onData(data);setFeedback(\"Archivo importado correctamente\");}catch(error){setFeedback(\"Error al importar el archivo\");console.error(\"Error al importar el Excel:\",error);}};const[fileName,setFileName]=React.useState(\"\");const[selectedFile,setSelectedFile]=React.useState(null);const fileInputRef=React.useRef();const handleButtonClick=()=>{fileInputRef.current.click();};const handleChange=e=>{const file=e.target.files[0];setFileName(file?file.name:\"\");setSelectedFile(file||null);};const handleUpload=()=>{if(selectedFile){const event={target:{files:[selectedFile]}};handleFileUpload(event);}};return/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'center',gap:'1.5rem',marginBottom:'18px',width:'100%'},children:/*#__PURE__*/_jsx(\"h2\",{className:\"import-title\",style:{margin:0,flex:1},children:\"Importar Art\\xEDculos desde Excel\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'center',gap:'1rem',marginBottom:'12px',width:'100%'},children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\".xlsx,.xls\",onChange:handleChange,style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"form-panel-button\",onClick:handleButtonClick,children:\"Seleccionar archivo\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'1rem',color:'#24416b',marginLeft:'0.5rem',fontWeight:600,fontFamily:'Montserrat, Segoe UI, Arial, sans-serif'},children:fileName?fileName:\"Sin archivos seleccionados\"}),selectedFile&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"form-panel-button upload-highlight\",style:{marginLeft:'8px',boxShadow:'0 6px 24px #2980b9',background:'linear-gradient(90deg, #2980b9 0%, #6dd5fa 100%)',fontWeight:'900',border:'2px solid #2980b9',color:'#fff'},onClick:handleUpload,children:\"Subir archivo\"}),feedback&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'1rem',color:feedback.includes('correctamente')?'#27ae60':'#c0392b',fontWeight:700,fontSize:'1rem'},children:feedback})]})]});};export default ImportExcel;","map":{"version":3,"names":["React","ExcelJS","jsx","_jsx","jsxs","_jsxs","ImportExcel","_ref","onData","feedback","setFeedback","useState","handleFileUpload","e","file","target","files","workbook","Workbook","arrayBuffer","xlsx","load","worksheet","worksheets","data","headers","getRow","values","slice","map","h","i","toString","concat","eachRow","row","rowNumber","rowData","item","forEach","header","toLowerCase","push","error","console","fileName","setFileName","selectedFile","setSelectedFile","fileInputRef","useRef","handleButtonClick","current","click","handleChange","name","handleUpload","event","style","width","children","display","alignItems","justifyContent","gap","marginBottom","className","margin","flex","ref","type","accept","onChange","onClick","fontSize","color","marginLeft","fontWeight","fontFamily","boxShadow","background","border","includes"],"sources":["D:/GitHub/GestionArticulos/frontend/src/components/ImportExcel.js"],"sourcesContent":["import React from \"react\";\r\nimport ExcelJS from \"exceljs\";\r\n\r\nconst ImportExcel = ({ onData }) => {\r\n  const [feedback, setFeedback] = React.useState(\"\");\r\n  const handleFileUpload = async (e) => {\r\n    try {\r\n      const file = e.target.files[0];\r\n      if (!file) return;\r\n\r\n      const workbook = new ExcelJS.Workbook();\r\n      const arrayBuffer = await file.arrayBuffer();\r\n      await workbook.xlsx.load(arrayBuffer);\r\n\r\n      const worksheet = workbook.worksheets[0];\r\n      const data = [];\r\n\r\n      const headers = worksheet\r\n        .getRow(1)\r\n        .values.slice(1)\r\n        .map((h, i) => (h ? h.toString() : `column${i + 1}`));\r\n\r\n      worksheet.eachRow((row, rowNumber) => {\r\n        if (rowNumber === 1) return;\r\n        const rowData = row.values.slice(1);\r\n        const item = {};\r\n        headers.forEach((header, i) => {\r\n          item[header.toLowerCase()] = rowData[i];\r\n        });\r\n        data.push(item);\r\n      });\r\n\r\n      onData(data);\r\n      setFeedback(\"Archivo importado correctamente\");\r\n    } catch (error) {\r\n      setFeedback(\"Error al importar el archivo\");\r\n      console.error(\"Error al importar el Excel:\", error);\r\n    }\r\n  };\r\n\r\n  const [fileName, setFileName] = React.useState(\"\");\r\n  const [selectedFile, setSelectedFile] = React.useState(null);\r\n  const fileInputRef = React.useRef();\r\n\r\n  const handleButtonClick = () => {\r\n    fileInputRef.current.click();\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const file = e.target.files[0];\r\n    setFileName(file ? file.name : \"\");\r\n    setSelectedFile(file || null);\r\n  };\r\n\r\n  const handleUpload = () => {\r\n    if (selectedFile) {\r\n      const event = { target: { files: [selectedFile] } };\r\n      handleFileUpload(event);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ width: '100%' }}>\r\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1.5rem', marginBottom: '18px', width: '100%' }}>\r\n        <h2 className=\"import-title\" style={{ margin: 0, flex: 1 }}>Importar Art√≠culos desde Excel</h2>\r\n      </div>\r\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1rem', marginBottom: '12px', width: '100%' }}>\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\".xlsx,.xls\"\r\n          onChange={handleChange}\r\n          style={{ display: 'none' }}\r\n        />\r\n        <button type=\"button\" className=\"form-panel-button\" onClick={handleButtonClick}>\r\n          Seleccionar archivo\r\n        </button>\r\n        <span style={{ fontSize: '1rem', color: '#24416b', marginLeft: '0.5rem', fontWeight: 600, fontFamily: 'Montserrat, Segoe UI, Arial, sans-serif' }}>\r\n          {fileName ? fileName : \"Sin archivos seleccionados\"}\r\n        </span>\r\n        {selectedFile && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"form-panel-button upload-highlight\"\r\n            style={{ marginLeft: '8px', boxShadow: '0 6px 24px #2980b9', background: 'linear-gradient(90deg, #2980b9 0%, #6dd5fa 100%)', fontWeight: '900', border: '2px solid #2980b9', color: '#fff' }}\r\n            onClick={handleUpload}\r\n          >\r\n            Subir archivo\r\n          </button>\r\n        )}\r\n        {feedback && (\r\n          <span style={{ marginLeft: '1rem', color: feedback.includes('correctamente') ? '#27ae60' : '#c0392b', fontWeight: 700, fontSize: '1rem' }}>{feedback}</span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImportExcel;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}